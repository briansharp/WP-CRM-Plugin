
	function setlocations(){
		var elm = document.getElementById('sel_customer');
		var cusid = elm.options[elm.selectedIndex].value;
		var selectobject = document.getElementById("sel_location");
		var firstrun = 0;
		for (var i=0; i<selectobject.length; i++){
			if( cusid == selectobject.options[i].value){
				selectobject.options[i].className = "show";	
				if (firstrun == 0){
					selectobject.options[i].setAttribute("selected", true);
					firstrun = 1;
				}
			} else {
				selectobject.options[i].removeAttribute("selected");
				selectobject.options[i].className = "hide";			
			}
		}
	}
	


	
	
	function validateInitTicket() {
		var e = sel_customer.options[sel_customer.selectedIndex].value;
		var checkpassed = true;
		if(e==='' || e == "select"){
			document.getElementById("sel_customer").className += " alert";
			checkpassed = false;
		}	else {document.getElementById("sel_customer").className = "";}	
		
		e = document.forms["frm_initTicket"]["txt_contact"].value;
		if (e == null || e.trim() == "") {
			document.getElementById("txt_contact").className += " alert";
			checkpassed = false;
		}	else {document.getElementById("txt_contact").className = "";}	
		
		e = assign_tech.options[assign_tech.selectedIndex].value;
		if(e==='' || e == "select"){
			document.getElementById("assign_tech").className += " alert";
			checkpassed = false;
		}	else {document.getElementById("assign_tech").className = "";}
			
		e = ddlSupType.options[ddlSupType.selectedIndex].value;
		if(e==='' || e == "select"){
			document.getElementById("ddlSupType").className += " alert";
			checkpassed = false;
		}	else {document.getElementById("ddlSupType").className = "";}

	
		e = document.forms["frm_initTicket"]["txt_description"].value;
		if (e == null || e.trim() == "") {
			document.getElementById("txt_description").className += " alert";
			checkpassed = false;
		}	else {document.getElementById("txt_description").className = "";}	
		return checkpassed;		
    }
	
	
	function validateUpdateEventForm() {
		var checkpassed = true;
		e = document.forms["frm_updateevent"]["txt_contact"].value;
		if (e == null || e.trim() == "") {
			document.getElementById("txt_contact").className += " alert";
			checkpassed = false;
		}	else {document.getElementById("txt_contact").className = "";}	
		
		
		e = document.forms["frm_updateevent"]["txt_description"].value;
		if (e == null || e.trim() == "") {
			document.getElementById("txt_description").className += " alert";
			checkpassed = false;
		}	else {document.getElementById("txt_description").className = "";}
		
		e = document.forms["frm_updateevent"]["txt_resolution"].value;
		if (e == null || e.trim() == "") {
			document.getElementById("txt_resolution").className += " alert";
			checkpassed = false;
		}	else {document.getElementById("txt_resolution").className = "";}
		
		var x = document.forms["frm_updateevent"]["start_date"].value.trim();
		var y = document.forms["frm_updateevent"]["end_date"].value.trim();
		if (x == null || x == "") {
			document.getElementById("timein").className += " alert";
			checkpassed = false;
		}	else {document.getElementById("timein").className = "time-picker";} 
		if (y == null || y == "") {
			document.getElementById("timeout").className += " alert";
			checkpassed = false;
		}	else {document.getElementById("timeout").className = "time-picker";}
		if (y < x) {
			alert("End date cannot be prior to start date");
			checkpassed = false;
		}   else if (x < y) {
			alert("If event spans multiple days, please create seperate entries.");
			checkpassed = false;
		}
		else {
			var e;
			
			e = document.getElementById("sel_hourin");
			var hin = e.options[e.selectedIndex].value;
			e = document.getElementById("sel_minin");
			var min = e.options[e.selectedIndex].value;
			e = document.getElementById("sel_ampmin");
			var ain = e.options[e.selectedIndex].value;
			if (ain == "pm") {hin = hin + 12;}
			
			e = document.getElementById("sel_hourout");
			var hout = e.options[e.selectedIndex].value;
			e = document.getElementById("sel_minout");
			var mout = e.options[e.selectedIndex].value;
			e = document.getElementById("sel_ampmout");
			var aout = e.options[e.selectedIndex].value;
			if (aout == "pm") {hout = hout + 12;}
			
			var tin = new Date(x + " " + hin + ":" + min);
			var tout = new Date(y + " " + hout + ":" + mout);
			if (tout < tin) {
				alert("Time out cannot be before time in.");
				checkpassed = false;
			}	
		}
		return checkpassed;
    }
	
	
	function validateForm() {
		var e = document.forms["frm_createevent"]["txt_contact"].value;
		if (e == null || e == "") {
			alert("Please include the customer contact name who initiated this event.");
			return false;
		}	
		e = document.forms["frm_createevent"]["txt_description"].value;
		if (e == null || e == "") {
			alert("The discription of this issue cannot be blank.");
			return false;
		}	
		e = document.forms["frm_createevent"]["txt_resolution"].value;
		if (e == null || e == "") {
			alert("Please indicate how this issue was resolved.");
			return false;
		}	
		var x = document.forms["frm_createevent"]["start_date"].value.trim();
		var y = document.forms["frm_createevent"]["end_date"].value.trim();
		if (x == null || x == "") {
			alert("Please select dates for time in and time out");
			return false;
		}	
		else if (y == null || y == "") {
			alert("Please select dates for time in and time out");
			return false;
		}	
		else if (y < x) {
			alert("Time out cannot be before time in.");
			return false;
		}
		else {
			var e;
			
			e = document.getElementById("sel_hourin");
			var hin = e.options[e.selectedIndex].value;
			e = document.getElementById("sel_minin");
			var min = e.options[e.selectedIndex].value;
			e = document.getElementById("sel_ampmin");
			var ain = e.options[e.selectedIndex].value;
			if (ain == "pm") {hin = hin + 12;}
			
			e = document.getElementById("sel_hourout");
			var hout = e.options[e.selectedIndex].value;
			e = document.getElementById("sel_minout");
			var mout = e.options[e.selectedIndex].value;
			e = document.getElementById("sel_ampmout");
			var aout = e.options[e.selectedIndex].value;
			if (aout == "pm") {hout = hout + 12;}
			
			var tin = new Date(x + " " + hin + ":" + min);
			var tout = new Date(y + " " + hout + ":" + mout);			

			if (tout < tin) {
				alert("Time out cannot be before time in.");
				return false;
			}	
		}	
    }

	
	
	function support_edit_click(id){
		document.getElementById("txt_" + id).removeAttribute("disabled");
		document.getElementById("cb_" + id).removeAttribute("disabled");
		document.getElementById("cancel_" + id).className="";
		document.getElementById("save_" + id).className="";
		document.getElementById("edit_" + id).className="hideme";
		document.getElementById("delete_" + id).className="hideme";
	}
	function support_delete_click(id){
		document.getElementById("cancel_" + id).className="";
		document.getElementById("confirmdelete_" + id).className="";
		document.getElementById("edit_" + id).className="hideme";
		document.getElementById("delete_" + id).className="hideme";
	}
	function edit_click(id){
		document.getElementById("txt_" + id).removeAttribute("disabled");
		document.getElementById("cb_" + id).removeAttribute("disabled");
		document.getElementById("cancel_" + id).className="submit";
		document.getElementById("save_" + id).className="submit";
		document.getElementById("edit_" + id).className="hideme";
		document.getElementById("delete_" + id).className="hideme";
	}
	function delete_click(id){
		document.getElementById("cancel_" + id).className="submit";
		document.getElementById("confirmdelete_" + id).className="submit";
		document.getElementById("edit_" + id).className="hideme";
		document.getElementById("delete_" + id).className="hideme";
	}
	function renameloc_click(id){
		document.getElementById("txtlocation_" + id).removeAttribute("disabled");
		document.getElementById("confirmrenamelocation_" + id).className="submit del-loc";
		document.getElementById("cancelrename_" + id).className="submit del-loc";
		document.getElementById("renamelocation_" + id).className="hideme";
		document.getElementById("confirmdeletelocation_" + id).className="hideme";
	}
	
	function showOptions(rowid){
		optsRow = document.getElementById('delete_' + rowid);
		dataRow = document.getElementById('row_' + rowid);
		optsRow.className = 'options showoptions';	
		dataRow.className = 'datarow hiderow';	
	}
	function hideOptions(rowid){
		document.getElementById('delete_' + rowid).className = 'options';	
		document.getElementById('row_' + rowid).className = 'datarow';	
	}
	
	
		
    //create querystring variables and open new window
    function search() {

        var dr = trimAll(document.getElementById("sel_daterange").value); //alert(dr);
        var sd;
        var ed;
        if (dr == "Specific Dates") {
            sd = trimAll(document.getElementById("start_date").value);   //alert(sd  ); 
            ed = trimAll(document.getElementById("end_date").value);   //alert( ed ); 
        }
		var sel_cust = document.getElementById("sel_customer");
        var cust = sel_cust.options[sel_cust.selectedIndex].value;   //alert( cust );

		var sel_tech = document.getElementById("sel_technician");
        var tech = sel_tech.options[sel_tech.selectedIndex].value;    //alert(tech  ); 
		
		var sel_sup = document.getElementById("sel_support");
        var st = sel_sup.options[sel_sup.selectedIndex].value;   //alert( st ); 
		
		var sel_sort = document.getElementById("ddlSortBy");
        var ob = trimAll(sel_sort.options[sel_sort.selectedIndex].innerHTML);   //alert( ob ); 
		
		var sort_dir = document.getElementById("ddlSortDirection");
        var od = trimAll(sort_dir.options[sort_dir.selectedIndex].innerHTML);   //alert( od ); 
		
		var group_by = document.getElementById("ddlGroupBy");
        var gb = trimAll(group_by.options[group_by.selectedIndex].innerHTML);   //alert( gb ); 
        
        var bill;
        if (document.getElementById("rb_billable").checked == true) { bill = "b";} //alert( 'billable' );  
        if (document.getElementById("rb_non_billable").checked == true) { bill = "n";   } //alert( 'not billable' ); 
        if (document.getElementById("rb_billable_both").checked == true) { bill = "a"; }   //alert( 'both billable' ); 

        var rem;
		
        if (document.getElementById("rbRemote").checked) { rem = "rem"; } //alert( 'remote' );
        if (document.getElementById("rbOnsite").checked) { rem = "ons";   }  //alert( 'onsite' );
        if (document.getElementById("rbAllLoc").checked) { rem = "all"; }   // alert( 'remote and onsite' );

        return "&dr=" + dr + "&sd=" + sd + "&ed=" + ed + "&cust=" + cust + "&tech=" + tech + "&st=" + st + "&ob=" + ob + "&od=" + od + "&bill=" + bill + "&rem=" + rem + "&gb=" + gb;  
       //dr:date range; sd:start date; ed:end date; cust:customer; tech:tech; st:supType; sb:sort by; sd:sort direction; bill:bill
   }

   function trimAll(sString) {
       while (sString.substring(0, 1) == ' ') {
           sString = sString.substring(1, sString.length);
       }
       while (sString.substring(sString.length - 1, sString.length) == ' ') {
           sString = sString.substring(0, sString.length - 1);
       }
       return sString;
   }
   
	function toggleDateFields(){
		var elm = document.getElementById('sel_daterange');
		var range = elm.options[elm.selectedIndex].text;
		var elm_start = document.getElementById("start_date");
		var elm_end = document.getElementById("end_date");
		if (range == "Specific Dates"){
			enableFields(elm_start, elm_end);
		} else {
			disableFields(elm_start, elm_end);		
		}
	}
	function enableFields(f1, f2){
		f1.removeAttribute("disabled");
		f2.removeAttribute("disabled");
	}
	function disableFields(f1, f2){
		f1.setAttribute("disabled", true);
		f2.setAttribute("disabled", true);
	}
   